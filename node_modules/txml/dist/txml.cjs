"use strict";function t(t,a){var n=(a=a||{}).pos||0,i=!!a.keepComments,o=!!a.keepWhitespace,s="<".charCodeAt(0),c=">".charCodeAt(0),f="-".charCodeAt(0),u="/".charCodeAt(0),h="!".charCodeAt(0),l="'".charCodeAt(0),d='"'.charCodeAt(0),p="[".charCodeAt(0),g="]".charCodeAt(0);function A(e){for(var r=[];t[n];)if(t.charCodeAt(n)==s){if(t.charCodeAt(n+1)===u){var a=n+2;if(n=t.indexOf(">",n),-1==t.substring(a,n).indexOf(e)){var l=t.substring(0,n).split("\n");throw new Error("Unexpected close tag\nLine: "+(l.length-1)+"\nColumn: "+(l[l.length-1].length+1)+"\nChar: "+t[n])}return n+1&&(n+=1),r}if(t.charCodeAt(n+1)===h){if(t.charCodeAt(n+2)==f){const e=n;for(;-1!==n&&(t.charCodeAt(n)!==c||t.charCodeAt(n-1)!=f||t.charCodeAt(n-2)!=f||-1==n);)n=t.indexOf(">",n+1);-1===n&&(n=t.length),i&&r.push(t.substring(e,n+1))}else{if(t.charCodeAt(n+2)===p&&t.charCodeAt(n+8)===p&&"cdata"===t.substr(n+3,5).toLowerCase()){var d=t.indexOf("]]>",n);-1==d?(r.push(t.substr(n+9)),n=t.length):(r.push(t.substring(n+9,d)),n=d+3);continue}{const e=n+1;n+=2;for(var A=!1;(t.charCodeAt(n)!==c||!0===A)&&t[n];)t.charCodeAt(n)===p?A=!0:!0===A&&t.charCodeAt(n)===g&&(A=!1),n++;r.push(t.substring(e,n))}}n++;continue}var m=x();r.push(m),"?"===m.tagName[0]&&(r.push(...m.children),m.children=[])}else{var v=y();if(o)v.length>0&&r.push(v);else{var C=v.trim();C.length>0&&r.push(C)}n++}return r}function y(){var e=n;return-2===(n=t.indexOf("<",n)-1)&&(n=t.length),t.slice(e,n+1)}var m="\r\n\t>/= ";function v(){for(var e=n;-1===m.indexOf(t[n])&&t[n];)n++;return t.slice(e,n)}var C,b=a.noChildNodes||["img","br","input","meta","link","hr"];function x(){n++;const e=v(),r={};let a=[];for(;t.charCodeAt(n)!==c&&t[n];){var i=t.charCodeAt(n);if(i>64&&i<91||i>96&&i<123){for(var o,s=v(),f=t.charCodeAt(n);f&&f!==l&&f!==d&&!(f>64&&f<91||f>96&&f<123)&&f!==c;)n++,f=t.charCodeAt(n);if(f===l||f===d){if(o=N(),-1===n)return{tagName:e,attributes:r,children:a}}else o=null,n--;r[s]=o}n++}if(t.charCodeAt(n-1)!==u)if("script"==e){var h=n+1;n=t.indexOf("<\/script>",n),a=[t.slice(h,n)],n+=9}else if("style"==e){h=n+1;n=t.indexOf("</style>",n),a=[t.slice(h,n)],n+=8}else-1===b.indexOf(e)?(n++,a=A(e)):n++;else n++;return{tagName:e,attributes:r,children:a}}function N(){var e=t[n],r=n+1;return n=t.indexOf(e,r),t.slice(r,n)}function O(){if(!a||!a.attrName||!a.attrValue)return-1;var e=new RegExp("\\s"+a.attrName+"\\s*=['\"]"+a.attrValue+"['\"]").exec(t);return e?e.index:-1}if(void 0!==a.attrValue)for(a.attrName=a.attrName||"id",C=[];-1!==(n=O());)-1!==(n=t.lastIndexOf("<",n))&&C.push(x()),t=t.substr(n),n=0;else C=a.parseNode?x():A("");if(a.filter&&Array.isArray(C)&&(C=r(C,a.filter)),a.simplify){return e(Array.isArray(C)?C:[C])}return a.setPos&&"object"==typeof C&&!Array.isArray(C)&&(C.pos=n),C}function e(t){var r={};if(!t.length)return"";if(1===t.length&&"string"==typeof t[0])return t[0];for(var a in t.forEach(function(t){if("object"==typeof t){r[t.tagName]||(r[t.tagName]=[]);var a=e(t.children);r[t.tagName].push(a),Object.keys(t.attributes).length&&"object"==typeof a&&!Array.isArray(a)&&(a._attributes=t.attributes)}}),r)1==r[a].length&&(r[a]=r[a][0]);return r}function r(t,e,a=0,n=""){var i=[];return t.forEach(function(t,o){if("object"==typeof t&&e(t,o,a,n)&&i.push(t),"object"==typeof t&&t.children){var s=r(t.children,e,a+1,(n?n+".":"")+o+"."+t.tagName);i=i.concat(s)}}),i}exports.filter=r,exports.getElementById=function(r,a,n){var i=t(r,{attrValue:a});return n?e(i):i[0]},exports.getElementsByClassName=function(r,a,n){const i=t(r,{attrName:"class",attrValue:"[a-zA-Z0-9- ]*"+a+"[a-zA-Z0-9- ]*"});return n?e(i):i},exports.parse=t,exports.simplify=e,exports.simplifyLostLess=function t(e,r={}){var a={};return e.length?1===e.length&&"string"==typeof e[0]?Object.keys(r).length?{_attributes:r,value:e[0]}:e[0]:(e.forEach(function(e){if("object"==typeof e){a[e.tagName]||(a[e.tagName]=[]);var r=t(e.children||[],e.attributes);a[e.tagName].push(r),Object.keys(e.attributes).length&&"object"==typeof r&&!Array.isArray(r)&&(r._attributes=e.attributes)}}),a):a},exports.stringify=function(t){if(!t)return"";var e="";function r(t){if(t)for(var r=0;r<t.length;r++){var n=t[r];"string"==typeof n?e+=n.trim():n&&a(n)}}function a(t){if(t){for(var a in e+="<"+t.tagName,t.attributes){var n=t.attributes[a];null===n?e+=" "+a:-1===n.indexOf('"')?e+=" "+a+'="'+n.trim()+'"':e+=" "+a+"='"+n.trim()+"'"}"?"!==t.tagName[0]?(e+=">",r(t.children),e+="</"+t.tagName+">"):e+="?>"}}return r(Array.isArray(t)?t:[t]),e},exports.toContentString=function t(e){if(Array.isArray(e)){var r="";return e.forEach(function(e){r=(r+=" "+t(e)).trim()}),r}return"object"==typeof e&&null!==e?t(e.children):" "+e};
